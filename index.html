<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>êµì‚¬ì˜ êµìœ¡ê³¼ì • í•´ì„ì„ í†µí•œ ì˜ë¯¸ êµ¬ì„±ì˜ ì½”ë“œ ìœ í˜• íƒêµ¬(Që°©ë²•ë¡ )</title>
<style>
    :root{ --bg:#0f172a; --panel:#111827; --card:#1f2937; --muted:#94a3b8; --text:#e5e7eb; --accent:#6366f1; --ok:#22c55e; --warn:#f59e0b; --bad:#ef4444; }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Apple SD Gothic Neo,Noto Sans KR,sans-serif}
    header{position:sticky;top:0;z-index:50;background:linear-gradient(180deg,rgba(15,23,42,.95),rgba(15,23,42,.6));backdrop-filter:blur(8px);border-bottom:1px solid #1f2937}
    .wrap{max-width:1200px;margin:0 auto;padding:16px}
    h1{font-size:20px;margin:0 0 6px}
    .sub{color:var(--muted);font-size:13px}
    .hidden{display:none}
    button,select,input,textarea{background:var(--card);color:var(--text);border:1px solid #334155;border-radius:10px;padding:10px 12px;font-size:14px}
    button{font-weight:700;cursor:pointer}
    button[disabled]{opacity:.6;cursor:not-allowed}
    button:hover{border-color:var(--accent)}
    input,textarea,select{width:100%}
    .grid{display:grid;grid-template-columns:320px 1fr;gap:16px;margin-top:12px}
    #pool,.col{background:var(--panel);border:1px solid #2b3647;border-radius:12px}
    #pool{padding:12px;min-height:220px}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0}
    .note{font-size:13px;color:var(--muted)}
    .cols{display:grid;gap:10px}
    .row{display:grid;gap:10px;grid-template-columns:repeat(9,1fr)}
    .col{min-height: 80px;padding:8px;display:flex;flex-direction:column}
    .col-header{display:flex;align-items:center;justify-content:space-between;padding:4px 6px;margin-bottom:6px;border-bottom:1px dashed #334155}
    .tag{font-size:12px;color:var(--muted)}
    .cap{font-size:12px}
    .bucket{display:flex;flex-direction:column;gap:6px}
    .card{font-size: 13px; background:var(--card);border:1px solid #334155;border-radius:12px;padding: 8px 10px;cursor:grab;margin-bottom:6px}
    .card.dragging{opacity:.6}
    .col.over{outline:2px dashed var(--accent);outline-offset:-4px}
    .count-ok{color:var(--ok)}
    .count-warn{color:var(--warn)}
    .count-bad{color:var(--bad)}
    .small{font-size:12px}
    .chips{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
    .chip{background:#0b1222;border:1px solid #2b3647;border-radius:999px;padding:2px 8px;font-size:12px}
    .page{max-width:900px;margin:20px auto;padding:16px;background:var(--panel);border:1px solid #2b3647;border-radius:14px}
    .row2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    label{font-size:13px;color:var(--muted);display:block;margin:10px 0 6px}
    .checkbox-group{display:flex;flex-direction:column;gap:8px;margin-top:8px}
    .checkbox-item{display:flex;align-items:center;gap:8px}
    .checkbox-item input[type="checkbox"]{width:16px;height:16px;margin:0;vertical-align:middle}
    .modal.hidden { display: none; }
    .modal { position: fixed; inset: 0; z-index: 1000; }
    .modal__overlay { position:absolute; inset:0; background: rgba(0,0,0,.5); backdrop-filter: blur(2px); }
    .modal__content { position:relative; max-width: 720px; margin: 8vh auto; background: var(--panel); border:1px solid #2b3647; border-radius: 12px; padding: 16px; }
  #poolContainer { border-right: 1px dashed #ccc; }
  #poolList { display:block; max-height:400px; overflow-y:auto; overflow-x:hidden; padding:8px; width:100%; box-sizing:border-box; scrollbar-gutter:stable; }
  #poolList .card { display:block; width:100%; margin-bottom:8px; }
#submitBtn { font-size:18px; font-weight:bold; padding:14px 22px; background:var(--accent); color:#fff; border-radius:12px; border:none; }
#submitBtn:hover { background:#4338ca; }
</style>
<style>
:root { --card-w: 240px; }
@media (max-width: 1600px) { :root { --card-w: 220px; } }
@media (max-width: 1440px) { :root { --card-w: 200px; } }
@media (max-width: 1280px) { :root { --card-w: 180px; } }
.page { max-width: 98vw !important; }
.grid { grid-template-columns: clamp(200px, 18vw, 280px) 1fr !important; }
.row { grid-template-columns: repeat(9, minmax(var(--card-w), 1fr)) !important; }
#pool .card { width: var(--card-w); }
.col .bucket .card { width: 100%; }
.row { gap: 8px !important; }
.cols { gap: 8px !important; }
.modal.hidden { display: none; }
.modal { position: fixed; inset: 0; z-index: 1000; }
.modal__overlay { position:absolute; inset:0; background: rgba(0,0,0,.5); backdrop-filter: blur(2px); }
.modal__content { position:relative; max-width: 720px; margin: 8vh auto; background: var(--panel); border:1px solid #2b3647; border-radius: 12px; padding: 16px; }
</style>
<style>
.help-btn { background:#6366f1; color:#fff; font-weight:bold; border:none; border-radius:6px; padding:6px 12px; cursor:pointer; transition:background .2s, transform .1s; }
.help-btn:hover { background:#4f46e5; transform:scale(1.03); }
</style>
<style>
.board { border:1px solid #2b3647; border-radius:12px; padding:12px; background:var(--panel); }
</style>
<style>
.grid { position:relative; align-items:start; }
.grid::after { content:""; position:absolute; top:0; bottom:0; left:clamp(200px, 18vw, 280px); border-left:2px dashed #334155; pointer-events:none; z-index:1; }
.board { position:relative; overflow:hidden; background:var(--panel); border:1px solid #2b3647; border-radius:12px; padding:12px; }
</style>
<style>
:root { --card-h: auto; }
.card { height: var(--card-h); overflow:auto; }
</style>
<style>.col-header .tag { color:#ffffff; font-weight:bold; font-size:15px; }</style>
<style>
#page2 aside #pool #poolList { display:block !important; max-height:50vh !important; min-height:240px; overflow-y:auto !important; overflow-x:hidden !important; padding:8px; box-sizing:border-box; scrollbar-gutter:stable; }
#page2 aside #pool #poolList .card { width:100% !important; }
</style></head>
<body>
<header>
  <div class="wrap">
    <h1>êµì‚¬ì˜ êµìœ¡ê³¼ì • í•´ì„ì„ í†µí•œ ì˜ë¯¸ êµ¬ì„±ì˜ ì½”ë“œ ìœ í˜• íƒêµ¬(Që°©ë²•ë¡ )</h1>
    <div class="sub">
      1ë‹¨ê³„ì—ì„œ ì‘ë‹µì ì •ë³´ë¥¼ ì…ë ¥í•˜ê³ , 2ë‹¨ê³„ì—ì„œ Qì§„ìˆ ë¬¸ ì¹´ë“œë¥¼ ë¶„í¬ì— ë§ê²Œ ë°°ì¹˜í•œ ë’¤ ì œì¶œë¶€íƒë“œë¦½ë‹ˆë‹¤.<br/>
      ì œê³µí•´ì£¼ì‹  ê°œì¸ ì •ë³´ ë° ì‘ë‹µ ê²°ê³¼ëŠ” ì—°êµ¬ì—ë§Œ ì‚¬ìš©ë˜ë©°, ì—°êµ¬ ì¢…ë£Œ ì¦‰ì‹œ íê¸°ë©ë‹ˆë‹¤.
    </div>
  </div>
</header>

<main class="wrap">
  <!-- PAGE 1 -->
  <section class="page" id="page1">
    <h2 style="margin:0 0 12px">1ë‹¨ê³„: ì‘ë‹µì ì •ë³´ë¥¼ ì…ë ¥í•˜ì—¬ ì£¼ì„¸ìš”.</h2>
    <div>
      <label for="career">ì„ ìƒë‹˜ì˜ êµì§ ê²½ë ¥ì„ ì„ íƒí•˜ì—¬ ì£¼ì„¸ìš”. *</label>
      <select id="career" required="">
        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
        <option value="under5">5ë…„ ë¯¸ë§Œ</option>
        <option value="5to10">5ë…„ ì´ìƒ ~ 10ë…„ ë¯¸ë§Œ</option>
        <option value="10to15">10ë…„ ì´ìƒ ~ 15ë…„ ë¯¸ë§Œ</option>
        <option value="15to20">15ë…„ ì´ìƒ ~ 20ë…„ ë¯¸ë§Œ</option>
        <option value="20to25">20ë…„ ì´ìƒ ~ 25ë…„ ë¯¸ë§Œ</option>
        <option value="25plus">25ë…„ ì´ìƒ</option>
      </select>
    </div>
    <div>
      <label for="schoolLevel">ì„ ìƒë‹˜ê»˜ì„œ í˜„ì¬ ê·¼ë¬´í•˜ê³  ê³„ì‹  í•™êµê¸‰ì„ ì„ íƒí•˜ì—¬ ì£¼ì„¸ìš”. *</label>
      <select id="schoolLevel" required="">
        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
        <option value="middle">ì¤‘í•™êµ</option>
        <option value="high">ê³ ë“±í•™êµ</option>
      </select>
    </div>

    <div style="margin:14px 0">
      <label>ì„ ìƒë‹˜ê»˜ì„œëŠ” ì•„ë˜ì™€ ê°™ì€ ì‘ì—…ì— ì°¸ì—¬í•˜ì‹  ì ì´ ìˆë‚˜ìš”? (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥, ì „í˜€ ì—†ìŒ ì„ íƒ ì‹œ ë‹¤ë¥¸ í•­ëª© ì„ íƒ ë¶ˆê°€) *</label>
      <div class="checkbox-group" id="experience-options">
        <label class="checkbox-item"><input name="experience" type="checkbox" value="curriculumDev"/> êµ­ê°€ìˆ˜ì¤€ ì§€ë¦¬ê³¼ êµìœ¡ê³¼ì • ê°œë°œ ì—°êµ¬</label>
        <label class="checkbox-item"><input name="experience" type="checkbox" value="textbookAuth"/> ì§€ë¦¬ê³¼ ê²€Â·ì¸ì • êµê³¼ì„œ ì§‘í•„(ê²€í†  í¬í•¨)</label>
        <label class="checkbox-item"><input name="experience" type="checkbox" value="textbookReview"/> ì§€ë¦¬ê³¼ êµê³¼ì„œ ê²€Â·ì¸ì • ì—…ë¬´</label>
        <label class="checkbox-item"><input name="experience" type="checkbox" value="materialDev"/> ì§€ë¦¬ê³¼ ê°œì • êµìœ¡ê³¼ì • ê´€ë ¨ êµìˆ˜Â·í•™ìŠµ ë° í‰ê°€ ìë£Œ ê°œë°œ</label>
        <label class="checkbox-item"><input name="experience" type="checkbox" value="trainingInstructor"/> ì§€ë¦¬ê³¼ ê°œì • êµìœ¡ê³¼ì • ì„ ë„ êµì› ì—°ìˆ˜ ê°•ì‚¬</label>
        <label class="checkbox-item"><input name="experience" type="checkbox" value="curriculumLeader"/> ì§€ë¦¬ê³¼ ê°œì • êµìœ¡ê³¼ì • ì„ ë„ êµì›</label>
        <label class="checkbox-item"><input name="experience" type="checkbox" value="plc"/> ì§€ë¦¬ ê´€ë ¨ ì „ë¬¸ì  êµì› í•™ìŠµ ê³µë™ì²´ í™œë™(í•™êµ ì•ˆ, í•™êµ ë°– ëª¨ë‘ í¬í•¨)</label>
        <label class="checkbox-item"><input name="experience" type="checkbox" value="other"/> ê¸°íƒ€: <input id="otherExp" placeholder="ì§ì ‘ ì…ë ¥" style="margin-left:6px;flex:1" type="text"/></label>
        <label class="checkbox-item"><input name="experience" type="checkbox" value="none"/> ì „í˜€ ì—†ìŒ</label>
      </div>
    </div>

    <div style="margin:14px 0">
      <label>ì—°êµ¬ìì˜ ì„¤ë¬¸ ë¶„ì„ í›„ ê° ì½”ë“œ ìœ í˜•ì„ ëŒ€í‘œí•˜ëŠ” ì„ ìƒë‹˜ë“¤ì„ ëŒ€ìƒìœ¼ë¡œ í•˜ëŠ” ì˜¨ë¼ì¸(ì¤Œ) ë©´ë‹´ì´ ì§„í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë©´ë‹´ ìš”ì²­ ì‹œ ë§ì€ ì°¸ì—¬ ë¶€íƒë“œë¦½ë‹ˆë‹¤. ìš”ì²­ ì‹œ ë©´ë‹´ ì°¸ì—¬ ê°€ëŠ¥í•˜ì‹­ë‹ˆê¹Œ? *</label>
      <select id="zoomConsent" required="">
        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
        <option value="yes">ì°¸ì—¬í•  ì˜í–¥ì´ ìˆìŠµë‹ˆë‹¤.</option>
        <option value="no">ì°¸ì—¬í•  ì˜í–¥ì´ ì—†ìŠµë‹ˆë‹¤.</option>
      </select>
    </div>

    <div style="margin-top:14px">
      <label for="email">ì´ë©”ì¼ *</label>
      <input id="email" required="" type="email"/>
    </div>
    <div>
      <label for="phone">í•¸ë“œí° ë²ˆí˜¸ *(ì„¤ë¬¸ ì°¸ì—¬ ê°ì‚¬ ê¸°í”„í‹°ì½˜ ë°œì†¡ìš©)</label>
      <input id="phone"/>
    </div>

    <div class="checkbox-group" style="margin-top:12px">
      <label class="checkbox-item"><input id="consent" type="checkbox"/> ì—°êµ¬ ì°¸ì—¬ì— ë™ì˜í•©ë‹ˆë‹¤.</label>
    </div>

    <div class="toolbar">
      <button id="nextBtn">ë‹¤ìŒ (ì •ë ¬ ë‹¨ê³„ë¡œ ì´ë™)</button>
    </div>
  </section>

  <!-- PAGE 2 -->
  <section class="page hidden" id="page2">
    <h2 style="margin:0 0 12px;display:flex;align-items:center;gap:12px;flex-wrap:wrap">
      2ë‹¨ê³„: ì„ ìƒë‹˜ê»˜ì„œ Qì§„ìˆ ë¬¸ ì¹´ë“œë¥¼ ì½ì–´ë³´ì‹  í›„, ë³¸ì¸ì˜ ìƒê°ì— ë”°ë¼ â€˜ë§¤ìš° ë¹„ë™ì˜â€™ì—ì„œë¶€í„° â€˜ë§¤ìš° ë™ì˜â€™ ì‚¬ì´ì˜ ìœ„ì¹˜ì— ì•Œë§ê²Œ ë°°ì¹˜í•´ ì£¼ì„¸ìš”.
      <button class="help-btn" id="helpBtn">ğŸ‘‰ Qì§„ìˆ ë¬¸ ë°°ì¹˜ ìš”ë ¹ì„ ë°˜ë“œì‹œ ì½ì–´ì£¼ì„¸ìš”</button>
    </h2>

    <div class="modal hidden" id="helpModal">
      <div class="modal__overlay"></div>
      <div class="modal__content">
        <h3 style="margin-top:0">Qì§„ìˆ ë¬¸ ë°°ì¹˜ ìš”ë ¹</h3>
        <ul style="line-height:1.75">
          <li>ì¹´ë“œ ë°°ì¹˜ ì „ 39ê°œì˜ ì§„ìˆ ì„ ë¨¼ì € ì½ì–´ì£¼ì„¸ìš”</li>
          <li>ì–‘ ê·¹ë‹¨(-4, 4)ë¶€í„° ë°°ì¹˜í•˜ê³  0ì„ ë§ˆì§€ë§‰ì— ë°°ì¹˜í•˜ë©´ í¸í•©ë‹ˆë‹¤.</li>
          <li>ê° ë‹¨ê³„ë³„ ìˆ˜ëŸ‰ì„ ë§ì¶°ì•¼ ì œì¶œ ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
        </ul>
        <div style="text-align:right"><button id="helpClose">ë‹«ê¸°</button></div>
      </div>
    </div>

    <div class="grid">
      <aside>
        <h2 style="margin:8px 0 6px;font-size:16px">ì¹´ë“œ í’€(ë¯¸ë°°ì¹˜)</h2>
        <div class="dropzone" data-score="pool" id="pool">
          <div class="note">ì—¬ê¸°ì— ë†“ìœ¼ë©´ ì¹´ë“œê°€ â€˜ë¯¸ë°°ì¹˜â€™ ìƒíƒœê°€ ë©ë‹ˆë‹¤.</div>
          <div class="bucket" id="poolList"></div>
        </div>
        <details style="margin-top:10px">
          <summary>í˜„ì¬ ë°°ì¹˜ ìš”ì•½</summary>
          <div class="small" id="summary" style="margin-top:6px;white-space:pre-wrap"></div>
        </details>
        <div class="toolbar" style="margin-top:16px">
          <button id="resetBtn">ë¶„í¬ ì´ˆê¸°í™”</button>
          <button id="backBtn">ë’¤ë¡œ (ì‘ë‹µì ì •ë³´)</button>
          <button id="submitBtn">ì œì¶œ</button>
        </div>
      </aside>
      <section>
        <h2 style="margin:8px 0 6px;font-size:16px">Qì†ŒíŒ… ë¶„í¬ë„</h2>
        <div class="board"><div class="cols"><div class="row" id="row"></div></div></div>
      </section>
    </div>

    <div class="modal hidden" id="thankModal">
      <div class="modal__overlay"></div>
      <div class="modal__content">
        <h3>ì„¤ë¬¸ ì œì¶œ ì™„ë£Œ</h3>
        <p>ì„¤ë¬¸ì— ì°¸ì—¬í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.</p>
        <div style="text-align:right; display:flex; gap:8px; justify-content:flex-end;">
          <button id="thankClose">ë‹«ê¸°</button>
        </div>
      </div>
    </div>
  </section>
</main>

<!-- ===== Token Validation via JSONP (CORS-free) ===== -->
<script>
(function(){
  const TOKEN_API_URL = "https://script.google.com/macros/s/AKfycbzhxw3kVbBBEJhPGAHXBxoL4S7vZKbqwCK5I5PeaeYEDLIO0u1l2VYwTpAMi-ywRem6og/exec";

  function getTokenFromURL(){
    try{
      const u = new URL(window.location.href);
      return (u.searchParams.get('token') || u.searchParams.get('t') || '').trim();
    }catch(_){ return ''; }
  }

  function jsonp(url, timeoutMs=6000){
    return new Promise((resolve, reject)=>{
      const cb = "__tokencb_" + Math.random().toString(36).slice(2);
      window[cb] = (data)=>{ cleanup(); resolve(data); };
      const s = document.createElement('script');
      s.src = url + (url.includes('?')?'&':'?') + "callback=" + cb;
      s.async = true;

      const to = setTimeout(()=>{ cleanup(); reject(new Error("timeout")); }, timeoutMs);
      s.onerror = ()=>{ cleanup(); reject(new Error("script-error")); };

      function cleanup(){
        clearTimeout(to);
        if (s && s.parentNode) s.parentNode.removeChild(s);
        try{ delete window[cb]; }catch(_){ window[cb] = undefined; }
      }
      document.head.appendChild(s);
    });
  }

  async function verifyTokenOnce(){
    const t = getTokenFromURL();
    if(!t){ window.__TOKEN_VALID__ = false; window.__TOKEN_STATUS__ = 'missing'; return; }
    try{
      const url = TOKEN_API_URL + "?action=checkToken&token=" + encodeURIComponent(t);
      const data = await jsonp(url);
      if (data && data.ok && data.status === 'valid'){
        window.__TOKEN_VALID__ = true;  window.__TOKEN_STATUS__ = 'valid';
      } else if (data && data.status === 'used'){
        window.__TOKEN_VALID__ = false; window.__TOKEN_STATUS__ = 'used';
      } else {
        window.__TOKEN_VALID__ = false; window.__TOKEN_STATUS__ = 'invalid';
      }
    }catch(e){
      window.__TOKEN_VALID__ = false; window.__TOKEN_STATUS__ = 'error';
    }
  }

  window.__TOKEN_VALID__ = false;
  window.__TOKEN_STATUS__ = 'checking';
  verifyTokenOnce();

  window.__ensureTokenOK__ = async function(){
    if (window.__TOKEN_STATUS__ === 'checking'){
      await new Promise(r=> setTimeout(r, 200));
    }
    if (window.__TOKEN_VALID__ === true) return true;
    const st = window.__TOKEN_STATUS__;
    if (st === 'missing'){
      alert('ì´ˆëŒ€ ë©”ì¼ë¡œ ë°›ì€ ê°œì¸ ì „ìš© ë§í¬ë¡œ ì ‘ì†í•´ ì£¼ì„¸ìš”. (í† í° ì—†ìŒ)');
    } else if (st === 'used'){
      alert('ì´ë¯¸ ì‚¬ìš©ëœ ë§í¬ì…ë‹ˆë‹¤. ì„¤ë¬¸ì„ ë‹¤ì‹œ ì§„í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    } else if (st === 'invalid'){
      alert('ìœ íš¨í•˜ì§€ ì•Šì€ ë§í¬ì…ë‹ˆë‹¤. ì´ˆëŒ€ ë©”ì¼ì˜ ë§í¬ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ ì£¼ì„¸ìš”.');
    } else {
      alert('ë§í¬ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.');
    }
    return false;
  };
})();
</script>

<script>
// === Uniform card height ===
function setUniformCardSize(){
  document.querySelectorAll('.card').forEach(c=>{ c.style.height='auto'; });
  let maxH = 0;
  document.querySelectorAll('.card').forEach(c=>{ maxH = Math.max(maxH, c.offsetHeight); });
  if(maxH < 56) maxH = 56;
  document.documentElement.style.setProperty('--card-h', maxH + 'px');
}
window.addEventListener('resize', ()=> setUniformCardSize());
</script>

<script>
/* ===== ì•„ë˜ ì˜ì—­ì€ ì›ë˜ ì‚¬ìš©í•˜ì‹  Q-sort ë³´ë“œ ë Œë”/ë“œë˜ê·¸/ì œì¶œ ë¡œì§ì„ ê·¸ëŒ€ë¡œ ìœ ì§€ ===== */
</script>

<!-- Google Sheets Integration -->
<script>
const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzhxw3kVbBBEJhPGAHXBxoL4S7vZKbqwCK5I5PeaeYEDLIO0u1l2VYwTpAMi-ywRem6og/exec";
function collectQsort(){
  const results = [];
  if (Array.isArray(columns)){
    columns.forEach(c => {
      const b = getBucket(c.el);
      const nodes = b ? Array.from(b.children) : [];
      nodes.forEach(node => {
        const id = Number(node.dataset.id);
        if (!Number.isNaN(id)) results.push({ id, score: Number(c.score) });
      });
    });
  }
  return results;
}
async function submitToSheet(){
  const submitBtn = document.getElementById('submitBtn');
  const payload = {
    career: (document.getElementById('career')?.value || "").trim(),
    schoolLevel: (document.getElementById('schoolLevel')?.value || "").trim(),
    experience: Array.from(document.querySelectorAll('input[name="experience"]:checked')).map(el => el.value),
    experienceOther: (document.getElementById('otherExp')?.value || "").trim(),
    zoomConsent: (document.getElementById('zoomConsent')?.value || "").trim(),
    email: (document.getElementById('email')?.value || "").trim(),
    phone: (document.getElementById('phone')?.value || "").trim(),
    qsort: collectQsort()
  };
  try {
    await fetch(APPS_SCRIPT_URL, { method: "POST", mode: "no-cors", body: JSON.stringify(payload) });
    const thankModal = document.getElementById('thankModal');
    if (thankModal) thankModal.classList.remove('hidden');
    return true;
  } catch (err) {
    alert('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ë¡œ ì œì¶œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.');
    if (submitBtn){ submitBtn.removeAttribute('disabled'); submitBtn.textContent = 'ì œì¶œ'; }
    if (typeof SUBMITTING !== 'undefined') SUBMITTING = false;
    return false;
  }
}
</script>

<section class="page hidden" id="page3">
  <h2>ì œì¶œ ì™„ë£Œ</h2>
  <p>ì„¤ë¬¸ì— ì°¸ì—¬í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ê²°ê³¼ê°€ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤.</p>
</section>

<script>
(function(){
  function bindConfirmToShowPage3(){
    const confirmBtn = document.getElementById('thankClose') || document.querySelector('#thankModal button');
    const thankModal = document.getElementById('thankModal');
    const submitBtn = document.getElementById('submitBtn');
    if (!confirmBtn || !thankModal) return false;
    if (confirmBtn.__boundOK) return true;
    confirmBtn.__boundOK = true;
    confirmBtn.addEventListener('click', function(){
      try {
        thankModal.classList.add('hidden');
        if (submitBtn){ submitBtn.textContent = 'ì œì¶œ ì™„ë£Œ'; submitBtn.disabled = true; }
        const p1 = document.getElementById('page1');
        const p2 = document.getElementById('page2');
        const p3 = document.getElementById('page3');
        if (p1) p1.classList.add('hidden');
        if (p2) p2.classList.add('hidden');
        if (p3) p3.classList.remove('hidden');
        window.scrollTo(0,0);
      } catch(e) { console.error('bindConfirmToShowPage3 error:', e); }
    });
    return true;
  }
  let cnt = 0;
  const intervalID = setInterval(() => {
    cnt++;
    if (bindConfirmToShowPage3() || cnt > 20) { clearInterval(intervalID); }
  }, 300);
})();
</script>
</body>
</html>
