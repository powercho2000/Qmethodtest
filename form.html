<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>설문 마감 안내</title>
  <meta name="robots" content="noindex" />
  <style>
    :root { --border:#e5e7eb; --muted:#6b7280; }
    * { box-sizing: border-box; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", sans-serif; margin: 0; background:#fafafa; }
    .wrap { max-width: 800px; margin: 40px auto; padding: 0 20px; }
    .card { background:#fff; border:1px solid var(--border); border-radius:14px; padding:28px; box-shadow: 0 1px 2px rgba(0,0,0,.04);}
    h1 { margin:0 0 10px; font-size: 22px; }
    p  { margin:6px 0; color: var(--muted); }

    /* ===== 마감 안내 모달 ===== */
    .closed-overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);backdrop-filter:blur(2px);z-index:1000}
    .closed-modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:1001;padding:20px}
    .closed-card{
      max-width:640px;width:100%;background:#111827;border:1px solid #2b3647;border-radius:16px;
      padding:28px;color:#e5e7eb;box-shadow:0 10px 30px rgba(0,0,0,.35)
    }
    .closed-title{margin:0 0 8px;font-size:20px;font-weight:800}
    .closed-desc{margin:0;line-height:1.75}
    .hidden{display:none !important;}

    /* (선택) 폼 레이아웃 예시 - 기존 폼이 있더라도 무시됨 */
    .form-grid{display:grid;grid-template-columns:1fr;gap:12px;margin-top:12px}
    label{font-weight:600;color:#111827}
    input, select, textarea{width:100%;border:1px solid var(--border);border-radius:10px;padding:10px 12px;font-size:15px;background:#fff}
    .actions{margin-top:16px;display:flex;gap:10px}
    button{padding:12px 16px;border-radius:10px;border:0;font-size:16px;cursor:pointer;background:#111827;color:#fff}
  </style>
</head>
<body>
  <main class="wrap">
    <div class="card">
      <h1>설문</h1>
      <p>설문 문항은 마감 시 비활성화됩니다.</p>

      <!-- (예시) 기존 폼 영역 - 실제 사용 중인 폼이 있어도 아래 스크립트가 전부 차단합니다 -->
      <form id="surveyForm" onsubmit="return submitToSheet(event)">
        <div class="form-grid">
          <div>
            <label for="q1">문항 1</label>
            <input id="q1" name="q1" type="text" placeholder="자유응답" />
          </div>
          <div>
            <label for="q2">문항 2</label>
            <select id="q2" name="q2">
              <option value="">선택</option>
              <option>예</option>
              <option>아니오</option>
            </select>
          </div>
          <div>
            <label for="q3">문항 3</label>
            <textarea id="q3" name="q3" rows="4" placeholder="의견을 남겨주세요"></textarea>
          </div>
        </div>
        <div class="actions">
          <button id="backBtn" type="button">이전</button>
          <button id="nextBtn" type="button">다음</button>
          <button id="submitBtn" type="submit">제출</button>
        </div>
      </form>
    </div>
  </main>

  <!-- ===== 마감 안내 모달 ===== -->
  <div id="closedOverlay" class="closed-overlay hidden" aria-hidden="true"></div>
  <div id="closedModal" class="closed-modal hidden" role="dialog" aria-modal="true" aria-labelledby="closedTitle" aria-describedby="closedDesc">
    <div class="closed-card">
      <h2 id="closedTitle" class="closed-title">설문이 종료되었습니다</h2>
      <p id="closedDesc" class="closed-desc">
        설문에 관심을 보여주신 선생님들께 깊은 감사의 마음을 전합니다.<br/>
        배명고 조경철 드림
      </p>
    </div>
  </div>

  <script>
    // ===== 🔒 설문 마감 스위치: 마감 시 true로 설정 =====
    const SURVEY_CLOSED = true;

    // ===== 실제 제출 함수(예시). 마감 시 아래에서 덮어씁니다. =====
    async function submitToSheet(e){
      e && e.preventDefault();
      alert('샘플 제출 함수입니다. (마감 시 덮어쓰기됨)');
      return false;
    }

    (function enforceClosed(){
      if (!SURVEY_CLOSED) return;

      // 1) 마감 모달 표시
      const ov = document.getElementById('closedOverlay');
      const md = document.getElementById('closedModal');
      [ov, md].forEach(el => el && el.classList.remove('hidden'));
      document.querySelector('main.wrap')?.setAttribute('aria-hidden','true');

      // 2) 모든 인터랙션 비활성화
      function disableAllControls(){
        const controls = document.querySelectorAll('button, input, select, textarea, a[href]');
        controls.forEach(el => {
          if (el.tagName === 'A') {
            el.addEventListener('click', e => e.preventDefault(), {capture:true});
            el.setAttribute('aria-disabled','true');
          } else {
            el.setAttribute('disabled','true');
          }
        });
        // 가시 버튼 숨김(선택)
        document.getElementById('nextBtn')?.classList.add('hidden');
        document.getElementById('backBtn')?.classList.add('hidden');
        document.getElementById('submitBtn')?.classList.add('hidden');
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', disableAllControls);
      } else {
        disableAllControls();
      }

      // 3) 제출 함수 강제 차단 (기존 글로벌 함수 덮어쓰기)
      window.submitToSheet = async function(evt){
        evt && evt.preventDefault();
        alert('설문 기한이 종료되었습니다.');
        return false;
      };

      // 4) 키보드/마우스 포커스가 모달 밖으로 나가지 않도록 간단 차단
      window.addEventListener('keydown', e => {
        if (e.key === 'Tab' || e.key === 'Enter') e.preventDefault();
      }, {capture:true});
      window.addEventListener('click', e => {
        if (md && !md.contains(e.target)) e.preventDefault();
      }, {capture:true});
    })();
  </script>
</body>
</html>
